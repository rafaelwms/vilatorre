<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="../template/adminTemplate.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="titulo">Sistema de Gerenciamento de Músicas - Home</ui:define>
	<ui:define name="principal">

	



			<h:form id="formPedidoLocal">
			<p:growl life="3000"/>
			<p:panel header=".: PEDIDOS :. " id="info">
				<h:panelGrid columns="2">
				
				<h:outputText value="Produto:" for="produtos"/>
				<p:selectOneMenu id="produtos" value="#{pedidoLocalBean.produto}" converter="produtoConverter"  filter="true" filterMatchMode="startsWith">  
        			    <f:selectItem  noSelectionOption="true" itemLabel="Selecione um produto."  />  
           				<f:selectItems value="#{pedidoLocalBean.produtos}" var="prod" itemLabel="#{prod.nome} &nbsp;&nbsp; #{prod.preco} " />  
      			     </p:selectOneMenu>
      			 
      			 
      			 
      			 <h:outputText value="Quantidade:" for="qtd"/>
      			 <p:inputText id="qtd" value="#{pedidoLocalBean.qtd}" onkeypress="mascara(this, numeros)"/>    
      			 
      			 <h:outputText value="Tipo de pedido:" for="tipoPedido"/>
      			 <p:selectOneMenu id="tipoPedido" value="#{pedidoLocalBean.tipoPedido}">        			    
           				<f:selectItems value="#{pedidoLocalBean.tipos}"/>  
      			     </p:selectOneMenu>
      			 
      			 
      			     
				<h:outputText value="Mesa:" for="mesa"/>
      			 <p:inputText id="mesa" value="#{pedidoLocalBean.mesa}" onkeypress="mascara(this, numeros)"/>    	
					
				</h:panelGrid>
			</p:panel>

			<p:panel>
				<p:menuButton value="Ações">
					<p:menuitem value="Novo Pedido" action="#{pedidoLocalBean.abrirPedido}" ajax="false"  tabindex="6"/>
					<p:menuitem value="Limpar" type="reset" ajax="false" tabindex="7" immediate="true"  />
				</p:menuButton>
			</p:panel>
			
			<p:panel header="Lista dos Pedidos Abertos" toggleable="true">
				

					<p:dataTable id="pedidoTable" var="ped" value="#{pedidoLocalBean.pedidosAbertos}"
						emptyMessage="Nenhum produto cadastrado.">
						
						
						<p:column headerText="ID">
					
							<p:commandButton value="#{ped.id_pedido}"  id="idi" type="button" />
						</p:column>
						
						<p:column headerText="Abertura do pedido">
							<h:outputText value="#{ped.abertura_pedido}" />
						</p:column>

						<p:column  headerText="Mesa">
							<h:outputText value="#{ped.num_mesa}" />
						</p:column>
						
						<p:column  headerText="Valor total">
							<h:outputText value="#{ped.valor_total}" />
						</p:column>
						
						<p:column headerText="Ações" style="width:30px;">
							<p:menuButton value="Selecione">
							<p:menuitem  value="Listar" actionListener="#{pedidoLocalBean.listarItems(ped)}" immediate="true"/>
							<p:menuitem value="Add Item" action="#{pedidoLocalBean.addItem(ped)}"/>
							</p:menuButton>
						
						
						<p:overlayPanel id="pgto" for="idi" showEffect="fade" hideEffect="fade" dynamic="true">
								<p:panel header="Pagamento">
								<h:panelGrid columns="2">
										
									<h:outputText value="Condição de pagamento."/>
									<p:selectOneRadio value="#{pedidoLocalBean.condicao}">
										<f:selectItem itemLabel="Parcial" itemValue="0"/>
										<f:selectItem itemLabel="Final" itemValue="1"/>
									</p:selectOneRadio>		
										
      								 <h:outputText value="Forma de Pagamento:" for="formapgto"/>
      								 <p:selectOneMenu id="formapgto" value="#{pedidoLocalBean.forma}">
      								 <f:selectItems value="#{pedidoLocalBean.formas}"/>
      								 </p:selectOneMenu>
      			 
      								 <h:outputText value="Bandeira:" for="band"/>
      								 <p:selectOneMenu id="band" value="#{pedidoLocalBean.bandeira}">
      								 <f:selectItems value="#{pedidoLocalBean.bandeiras}"/>
      								 </p:selectOneMenu>
      			 
      								 <h:outputText value="Desconto R$:" for="desc"/>
      								 <p:inputText id="desc" value="#{pedidoLocalBean.desconto}" onkeypress="mascara(this, moeda)"/>  
										
									<p:commandButton value="Confirmar"  action="#{pedidoLocalBean.pagar(ped)}" type="button" icon="ui-icon-check"/>
								</h:panelGrid>	
								<h:inputHidden value="#{ped}"/>	
								</p:panel>
							</p:overlayPanel>
						
						</p:column>
						
					</p:dataTable>
					</p:panel>
				
					

				</h:form>

</ui:define>
</ui:composition>