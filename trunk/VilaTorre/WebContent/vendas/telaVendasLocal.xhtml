<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="../template/adminTemplate.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="titulo">Sistema de Gerenciamento de Músicas - Home</ui:define>
	<ui:define name="principal">

	



			<h:form id="formPedidoLocal">
			<p:growl life="3000"/>
			<p:panel header=".: PEDIDOS :. " id="info">
				<h:panelGrid columns="2">
				
				<h:outputText value="Produto:" for="produtos"/>
				<p:selectOneMenu id="produtos" value="#{pedidoLocalBean.produto}" converter="produtoConverter"  filter="true" filterMatchMode="startsWith">  
        			    <f:selectItem  noSelectionOption="true" itemLabel="Selecione um produto."  />  
           				<f:selectItems value="#{pedidoLocalBean.produtos}" var="prod" itemLabel="#{prod.nome} &nbsp;&nbsp; #{prod.preco} " />  
      			     </p:selectOneMenu>
      			 
      			 
      			 
      			 <h:outputText value="Quantidade:" for="qtd"/>
      			 <p:inputText id="qtd" value="#{pedidoLocalBean.qtd}" onkeypress="mascara(this, numeros)"/>    
      			 
      			 <h:outputText value="Tipo de pedido:" for="tipoPedido"/>
      			 <p:selectOneMenu id="tipoPedido" value="#{pedidoLocalBean.tipoPedido}">        			    
           				<f:selectItems value="#{pedidoLocalBean.tipos}"/>  
      			     </p:selectOneMenu>
      			 
      			 
      			     
				<h:outputText value="Mesa:" for="mesa"/>
      			 <p:inputText id="mesa" value="#{pedidoLocalBean.mesa}" onkeypress="mascara(this, numeros)"/>    	
					
				</h:panelGrid>
			</p:panel>

			<p:panel>
				<p:menuButton value="Ações">
					<p:menuitem value="Novo Pedido" action="#{pedidoLocalBean.abrirPedido}" ajax="false"  tabindex="6"/>
					<p:menuitem value="Limpar" type="reset" ajax="false" tabindex="7" immediate="true"  />
				</p:menuButton>
			</p:panel>
			
			<p:panel header="Lista dos Pedidos Abertos" toggleable="true">
				

					<p:dataTable id="pedidoTable" var="ped" value="#{pedidoLocalBean.pedidosAbertos}"
						emptyMessage="Nenhum produto cadastrado.">
						
						
						<p:column headerText="ID">
							<h:outputText value="#{ped.id_pedido}" />
						</p:column>
						
						<p:column headerText="Abertura do pedido">
							<h:outputText value="#{ped.abertura_pedido}" />
						</p:column>

						<p:column  headerText="Mesa">
							<h:outputText value="#{ped.num_mesa}" />
						</p:column>
						
						<p:column  headerText="Valor total">
							<h:outputText value="#{ped.valor_total}" />
						</p:column>
						
						<p:column headerText="Ações">
							<p:commandButton  title="Adicionar Item ao Pedido" actionListener="#{pedidoLocalBean.addItem(ped)}" update=":formPedidoLocal" immediate="true" icon="ui-icon-pencil"/>
					&nbsp;&nbsp;
					<p:commandButton title="Detalhar Pedido"  actionListener="#{pedidoLocalBean.listarItems(ped)}" update=":formPedidoLocal:itemsPedidoTable" icon="ui-icon-trash" />
						</p:column>

					</p:dataTable>
					</p:panel>
					
					<p:panel header="Lista dos Items Pedidos Abertos" toggleable="true">
				

					<p:dataTable id="itemsPedidoTable" var="it" value="#{pedidoLocalBean.itemsPedido}"
						emptyMessage="Nenhuma Solicitação.">
						
						<h:inputHidden value="#{it.id}"/>
						<p:column headerText="Produto">
							<h:outputText value="#{it.produto.nome}" />
						</p:column>

						<p:column  headerText="Valor R$">
							<h:outputText value="#{it.produto.preco}" />
						</p:column>
						
						<p:column  headerText="Quantidade">
							<h:outputText value="#{it.qtd}" />
						</p:column>
						
						<p:column  headerText="Total R$">
							<h:outputText value="#{it.totalItem}" />
						</p:column>
						
						<p:column headerText="Ações">
							<p:commandButton  title="Adicionar Item ao Pedido" actionListener="#" update=":formPedidoLocal" immediate="true" icon="ui-icon-pencil"/>
					&nbsp;&nbsp;
					<p:commandButton title="Detalhar Pedido"  actionListener="#"  icon="ui-icon-trash" />
						</p:column>

					</p:dataTable>
					</p:panel>

				</h:form>

</ui:define>
</ui:composition>